<!DOCTYPE html><html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WebRTC 井字棋</title>
  <!-- 保留你的 style CSS 不變略 -->
  <style>
    /* 你的 style 內容保持原樣 */
  </style>
</head>
<body>
  <!-- 保留原始 HTML 結構 -->  <!-- 引入 QRCode 生成库 -->  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>  <!-- 引入 WebRTC 庫 -->  <script src="https://cdn.jsdelivr.net/npm/simple-peer@9.11.1/simplepeer.min.js"></script>  <script>
    // 修改的地方：WebRTC ICE servers，加入 TURN 支援
    const customICEServers = {
      iceServers: [
        {
          urls: [
            'stun:stun.l.google.com:19302',
            'stun:global.stun.twilio.com:3478?transport=udp'
          ]
        },
        {
          urls: 'turn:openrelay.metered.ca:80',
          username: 'openrelayproject',
          credential: 'openrelayproject'
        }
      ]
    };

    // 替代所有 peer = new SimplePeer({...}) 的地方，加上 config: customICEServers
    // 以下以 createHostConnection 為例：

    function createHostConnection() {
      const peer = new SimplePeer({
        initiator: true,
        trickle: false,
        config: customICEServers
      });
      // ...後續 peer.on(...) 保持原樣
    }

    function connectAsGuest(remoteSignal) {
      const peer = new SimplePeer({
        initiator: false,
        trickle: false,
        config: customICEServers
      });
      peer.signal(remoteSignal);
      // ...後續 peer.on(...) 保持原樣
    }

    // 其餘遊戲邏輯、UI 控制、連接建立流程、reset、move 等全保留
  </script></body>
</html>